<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‡Œì¡¸ì¤‘ ì „ë¬¸ AI ì‹œìŠ¤í…œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            color: #7f8c8d;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }
        
        .content-area {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
        }
        
        .tab {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }
        
        .tab:hover {
            color: #2980b9;
            background: rgba(52, 152, 219, 0.1);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .upload-area {
            border: 3px dashed #3498db;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: #2980b9;
            background: rgba(52, 152, 219, 0.05);
        }
        
        .upload-area.dragover {
            border-color: #27ae60;
            background: rgba(46, 204, 113, 0.1);
        }
        
        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(45deg, #27ae60, #229954);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        
        .question-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            margin-bottom: 20px;
            min-height: 100px;
            resize: vertical;
        }
        
        .question-input:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .ai-response {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border-left: 5px solid #3498db;
        }
        
        .emergency-info {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border: 2px solid #f44336;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .fast-check {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            border: 2px solid #4caf50;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .info-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .example-questions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        .example-question {
            padding: 15px;
            background: rgba(52, 152, 219, 0.1);
            border: 1px solid #3498db;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .example-question:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }
        
        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: rgba(39, 174, 96, 0.1);
            border: 1px solid #27ae60;
            color: #27ae60;
        }
        
        .alert-error {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid #e74c3c;
            color: #e74c3c;
        }
        
        .alert-warning {
            background: rgba(243, 156, 18, 0.1);
            border: 1px solid #f39c12;
            color: #f39c12;
        }
        
        .model-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e74c3c;
            animation: pulse 2s infinite;
        }
        
        .status-dot.online {
            background: #27ae60;
        }
        
        .status-dot.offline {
            background: #e74c3c;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .pdf-preview {
            background: rgba(52, 152, 219, 0.1);
            border: 1px solid #3498db;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .pdf-text {
            max-height: 200px;
            overflow-y: auto;
            font-size: 0.9em;
            line-height: 1.4;
            color: #555;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: relative;
                top: 0;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1;
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§  ë‡Œì¡¸ì¤‘ ì „ë¬¸ AI ì‹œìŠ¤í…œ</h1>
            <p>DeepSeek R1 1.5B ê¸°ë°˜ ì˜ë£Œ ì–´ì‹œìŠ¤í„´íŠ¸</p>
        </div>
        
        <div class="main-content">
            <div class="content-area">
                <div class="tabs">
                    <button class="tab active" onclick="showTab('upload')">ğŸ“„ ë¬¸ì„œ ì—…ë¡œë“œ</button>
                    <button class="tab" onclick="showTab('chat')">ğŸ’¬ AI ìƒë‹´</button>
                    <button class="tab" onclick="showTab('info')">ğŸ“Š ë‡Œì¡¸ì¤‘ ì •ë³´</button>
                </div>
                
                <!-- ë¬¸ì„œ ì—…ë¡œë“œ íƒ­ -->
                <div id="upload" class="tab-content active">
                    <h2>ì˜ë£Œ ë¬¸ì„œ ì—…ë¡œë“œ</h2>
                    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                        <div id="uploadText">
                            <h3>ğŸ“„ PDF íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</h3>
                            <p>ë‡Œì¡¸ì¤‘ ê´€ë ¨ ì˜ë£Œ ë¬¸ì„œ, ë…¼ë¬¸, ê°€ì´ë“œë¼ì¸ ë“±ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</p>
                        </div>
                        <input type="file" id="fileInput" accept=".pdf" style="display: none;" onchange="handleFileUpload(event)">
                    </div>
                    
                    <div id="uploadStatus"></div>
                    
                    <div class="info-card">
                        <h3>ğŸ’¡ ì—…ë¡œë“œ íŒ</h3>
                        <ul>
                            <li>PDF í˜•ì‹ì˜ ì˜ë£Œ ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš” (ìµœëŒ€ 10MB)</li>
                            <li>ë‡Œì¡¸ì¤‘ ê´€ë ¨ ë…¼ë¬¸, ê°€ì´ë“œë¼ì¸, êµìœ¡ ìë£Œ ë“±</li>
                            <li>ì—…ë¡œë“œëœ ë¬¸ì„œëŠ” AI ìƒë‹´ì—ì„œ ì°¸ê³  ìë£Œë¡œ í™œìš©ë©ë‹ˆë‹¤</li>
                            <li>ê°œì¸ ì˜ë£Œ ì •ë³´ëŠ” ì—…ë¡œë“œí•˜ì§€ ë§ˆì„¸ìš”</li>
                            <li>í…ìŠ¤íŠ¸ê°€ í¬í•¨ëœ PDFë§Œ ì§€ì›ë©ë‹ˆë‹¤</li>
                        </ul>
                    </div>
                </div>
                
                <!-- AI ìƒë‹´ íƒ­ -->
                <div id="chat" class="tab-content">
                    <h2>ë‡Œì¡¸ì¤‘ AI ìƒë‹´</h2>
                    
                    <div id="noDocumentWarning" class="alert alert-warning">
                        âš ï¸ ë” ì •í™•í•œ ë‹µë³€ì„ ìœ„í•´ ê´€ë ¨ ì˜ë£Œ ë¬¸ì„œë¥¼ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.
                    </div>
                    
                    <textarea 
                        id="questionInput" 
                        class="question-input" 
                        placeholder="ë‡Œì¡¸ì¤‘ ê´€ë ¨ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”&#10;ì˜ˆ: ë‡Œì¡¸ì¤‘ ì´ˆê¸° ì¦ìƒì€ ë¬´ì—‡ì¸ê°€ìš”?"
                    ></textarea>
                    
                    <button class="btn" onclick="askAI()" id="askButton">ğŸ¤– AIì—ê²Œ ì§ˆë¬¸í•˜ê¸°</button>
                    
                    <div id="loading" class="loading">
                        <div class="spinner"></div>
                        <p>AIê°€ ë‹µë³€ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                    </div>
                    
                    <div id="aiResponse"></div>
                    
                    <div class="example-questions">
                        <h3>ğŸ’¡ ì§ˆë¬¸ ì˜ˆì‹œ</h3>
                        <div class="example-question" onclick="setQuestion('ë‡Œì¡¸ì¤‘ì˜ ì£¼ìš” ì¦ìƒì€ ë¬´ì—‡ì¸ê°€ìš”?')">
                            Q1: ë‡Œì¡¸ì¤‘ì˜ ì£¼ìš” ì¦ìƒì€ ë¬´ì—‡ì¸ê°€ìš”?
                        </div>
                        <div class="example-question" onclick="setQuestion('ë‡Œì¡¸ì¤‘ ì˜ˆë°© ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”')">
                            Q2: ë‡Œì¡¸ì¤‘ ì˜ˆë°© ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”
                        </div>
                        <div class="example-question" onclick="setQuestion('ë‡Œì¡¸ì¤‘ ì‘ê¸‰ì²˜ì¹˜ ë°©ë²•ì€?')">
                            Q3: ë‡Œì¡¸ì¤‘ ì‘ê¸‰ì²˜ì¹˜ ë°©ë²•ì€?
                        </div>
                        <div class="example-question" onclick="setQuestion('ë‡Œì¡¸ì¤‘ ì¬í™œ ì¹˜ë£Œì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”')">
                            Q4: ë‡Œì¡¸ì¤‘ ì¬í™œ ì¹˜ë£Œì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”
                        </div>
                        <div class="example-question" onclick="setQuestion('ë‡Œì¡¸ì¤‘ ìœ„í—˜ ìš”ì¸ì€ ë¬´ì—‡ì¸ê°€ìš”?')">
                            Q5: ë‡Œì¡¸ì¤‘ ìœ„í—˜ ìš”ì¸ì€ ë¬´ì—‡ì¸ê°€ìš”?
                        </div>
                    </div>
                </div>
                
                <!-- ë‡Œì¡¸ì¤‘ ì •ë³´ íƒ­ -->
                <div id="info" class="tab-content">
                    <h2>ğŸ“Š ë‡Œì¡¸ì¤‘ ê¸°ë³¸ ì •ë³´</h2>
                    
                    <div class="fast-check">
                        <h3>ğŸ” FAST ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div>
                                <strong>F (Face - ì–¼êµ´)</strong>
                                <p>â€¢ ì–¼êµ´ í•œìª½ì´ ë§ˆë¹„</p>
                                <p>â€¢ ì›ƒì„ ë•Œ ì…ì´ í•œìª½ìœ¼ë¡œ ëŒì•„ê°</p>
                            </div>
                            <div>
                                <strong>A (Arm - íŒ”)</strong>
                                <p>â€¢ íŒ” í•œìª½ì— í˜ì´ ì—†ìŒ</p>
                                <p>â€¢ íŒ”ì„ ë“¤ì–´ì˜¬ë¦¬ê¸° ì–´ë ¤ì›€</p>
                            </div>
                            <div>
                                <strong>S (Speech - ì–¸ì–´)</strong>
                                <p>â€¢ ë§ì´ ì–´ëˆŒí•´ì§</p>
                                <p>â€¢ ë§ì„ ì´í•´í•˜ê¸° ì–´ë ¤ì›€</p>
                            </div>
                            <div>
                                <strong>T (Time - ì‹œê°„)</strong>
                                <p>â€¢ ìœ„ ì¦ìƒ ì¤‘ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´</p>
                                <p><strong>ì¦‰ì‹œ 119 ì‹ ê³ !</strong></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="emergency-info">
                        <h3>ğŸš¨ ì‘ê¸‰ ì¦ìƒ</h3>
                        <p><strong>ë‹¤ìŒ ì¦ìƒì´ ìˆìœ¼ë©´ ì¦‰ì‹œ ì‘ê¸‰ì‹¤ë¡œ!</strong></p>
                        <ul>
                            <li>ê°‘ì‘ìŠ¤ëŸ° ì‹¬í•œ ë‘í†µ</li>
                            <li>í•œìª½ ì–¼êµ´ì´ë‚˜ íŒ”ë‹¤ë¦¬ ë§ˆë¹„</li>
                            <li>ë§ì´ ì–´ëˆŒí•˜ê±°ë‚˜ ì´í•´ ë¶ˆê°€</li>
                            <li>ê°‘ì‘ìŠ¤ëŸ° ì‹œì•¼ ì¥ì• </li>
                            <li>ì‹¬í•œ ì–´ì§€ëŸ¼ì¦ê³¼ ë³´í–‰ ì¥ì• </li>
                            <li>ì˜ì‹ ì €í•˜</li>
                        </ul>
                    </div>
                    
                    <div class="info-card">
                        <h3>ğŸ¥ ì¹˜ë£Œ ê³¨ë“ íƒ€ì„</h3>
                        <div style="background: rgba(39, 174, 96, 0.1); padding: 15px; border-radius: 10px; margin-top: 10px;">
                            <p><strong>ë‡Œì¡¸ì¤‘ ì¹˜ë£Œì˜ ê³¨ë“ íƒ€ì„</strong></p>
                            <ul>
                                <li>í—ˆí˜ˆì„± ë‡Œì¡¸ì¤‘: ë°œìƒ í›„ 3-4.5ì‹œê°„ ë‚´</li>
                                <li>í˜ˆì „ ì œê±°ìˆ : ë°œìƒ í›„ 6-24ì‹œê°„ ë‚´</li>
                                <li><strong>ë¹ ë¥¸ ì¹˜ë£Œê°€ í›„ìœ ì¦ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤!</strong></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h3>ğŸ’¡ ì˜ˆë°© ë°©ë²•</h3>
                        <div style="background: rgba(52, 152, 219, 0.1); padding: 15px; border-radius: 10px; margin-top: 10px;">
                            <p><strong>ë‡Œì¡¸ì¤‘ ì˜ˆë°©ì„ ìœ„í•œ ìƒí™œ ìŠµê´€</strong></p>
                            <ul>
                                <li>ì •ê¸°ì ì¸ í˜ˆì•• ì²´í¬</li>
                                <li>ê¸ˆì—° ë° ì ˆì£¼</li>
                                <li>ê·œì¹™ì ì¸ ìš´ë™</li>
                                <li>ê· í˜• ì¡íŒ ì‹ë‹¨</li>
                                <li>ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬</li>
                                <li>ë‹¹ë‡¨ë³‘ ê´€ë¦¬</li>
                                <li>ì •ê¸° ê±´ê°•ê²€ì§„</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <h3>ğŸ”§ ì‹œìŠ¤í…œ ì„¤ì •</h3>
                
                <div class="model-status">
                    <div class="status-dot offline" id="modelStatus"></div>
                    <span id="modelStatusText">AI ëª¨ë¸ ì˜¤í”„ë¼ì¸</span>
                </div>
                
                <select id="modelSelect" style="width: 100%; padding: 10px; border-radius: 5px; margin-bottom: 20px;" onchange="changeModel()">
                    <option value="deepseek-r1:1.5b">DeepSeek R1 1.5B</option>
                    <option value="llama3.2">Llama 3.2</option>
                    <option value="gemma2">Gemma 2</option>
                </select>
                
                <button class="btn" onclick="connectModel()" id="connectButton">ğŸ”— ëª¨ë¸ ì—°ê²°</button>
                
                <div class="emergency-info">
                    <h3>ğŸš¨ ì‘ê¸‰ ì •ë³´</h3>
                    <div style="text-align: center; margin: 15px 0;">
                        <button class="btn btn-danger" onclick="call119()">ğŸ“ 119 ì‹ ê³ </button>
                    </div>
                    <p><strong>FAST ì²´í¬ ê²°ê³¼ ì–‘ì„± ì‹œ ì¦‰ì‹œ ì‹ ê³ !</strong></p>
                </div>
                
                <div class="fast-check">
                    <h3>â° ê³¨ë“ íƒ€ì„</h3>
                    <p style="text-align: center; font-size: 1.2em; font-weight: bold;">
                        ë‡Œì¡¸ì¤‘ ë°œìƒ í›„<br>
                        <span style="color: #e74c3c;">3-4.5ì‹œê°„ ë‚´</span><br>
                        ì¹˜ë£Œê°€ ì¤‘ìš”í•©ë‹ˆë‹¤!
                    </p>
                </div>
                
                <div class="info-card">
                    <h3>âš ï¸ ì˜ë£Œ ë©´ì±… ê³ ì§€</h3>
                    <p style="font-size: 0.9em;">
                        â€¢ ì´ ì •ë³´ëŠ” êµìœ¡ ëª©ì ì…ë‹ˆë‹¤<br>
                        â€¢ ì˜í•™ì  ì¡°ì–¸ì„ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤<br>
                        â€¢ ê±´ê°• ë¬¸ì œëŠ” ì˜ë£Œì§„ê³¼ ìƒë‹´í•˜ì„¸ìš”<br>
                        â€¢ ì‘ê¸‰ìƒí™© ì‹œ ì¦‰ì‹œ 119 ì‹ ê³ 
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let uploadedDocument = null;
        let aiModel = 'deepseek-r1:1.5b';
        let modelConnected = false;
        let pdfDocument = null;
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            // PDF.js ì›Œì»¤ ì„¤ì •
            if (typeof pdfjsLib !== 'undefined') {
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
            }
            
            // ëª¨ë¸ ìƒíƒœ ì´ˆê¸°í™”
            updateModelStatus(false);
            
            // ì—”í„° í‚¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.getElementById('questionInput').addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    askAI();
                }
            });
        });
        
        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
            if (!validateFile(file)) {
                return;
            }
            
            const uploadStatus = document.getElementById('uploadStatus');
            uploadStatus.innerHTML = `
                <div class="loading" style="display: block;">
                    <div class="spinner"></div>
                    <p>PDF ë¬¸ì„œë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                </div>
            `;
            
            try {
                // PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ
                const text = await extractTextFromPDF(file);
                
                if (!text || text.trim().length === 0) {
                    throw new Error('PDFì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ ê¸°ë°˜ PDFì´ê±°ë‚˜ ì†ìƒëœ íŒŒì¼ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                }
                
                uploadedDocument = {
                    name: file.name,
                    size: file.size,
                    content: text,
                    uploadTime: new Date().toLocaleString()
                };
                
                uploadStatus.innerHTML = `
                    <div class="alert alert-success">
                        âœ… ë¬¸ì„œ ë¶„ì„ ì™„ë£Œ!
                        <br><strong>íŒŒì¼ëª…:</strong> ${file.name}
                        <br><strong>í¬ê¸°:</strong> ${(file.size / 1024).toFixed(2)} KB
                        <br><strong>ì¶”ì¶œëœ í…ìŠ¤íŠ¸:</strong> ${text.length.toLocaleString()}ì
                        <br><strong>ì—…ë¡œë“œ ì‹œê°„:</strong> ${uploadedDocument.uploadTime}
                    </div>
                    <div class="pdf-preview">
                        <h4>ğŸ“„ ë¬¸ì„œ ë¯¸ë¦¬ë³´ê¸°</h4>
                        <div class="pdf-text">${text.substring(0, 500)}${text.length > 500 ? '...' : ''}</div>
                    </div>
                `;
                
                // ê²½ê³  ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
                const warning = document.getElementById('noDocumentWarning');
                if (warning) {
                    warning.style.display = 'none';
                }
                
            } catch (error) {
                console.error('PDF ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                uploadStatus.innerHTML = `
                    <div class="alert alert-error">
                        âŒ PDF ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}
                        <br>ğŸ’¡ ë‹¤ë¥¸ PDF íŒŒì¼ë¡œ ì‹œë„í•´ë³´ê±°ë‚˜ í…ìŠ¤íŠ¸ê°€ í¬í•¨ëœ PDFë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
                    </div>
                `;
            }
        }
        
        // íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
        function validateFile(file) {
            const maxSize = 10 * 1024 * 1024; // 10MB
            const allowedTypes = ['application/pdf'];
            
            if (!allowedTypes.includes(file.type)) {
                showError('PDF íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return false;
            }
            
            if (file.size > maxSize) {
                showError('íŒŒì¼ í¬ê¸°ê°€ 10MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            }
            
            return true;
        }
        
        // PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ í•¨ìˆ˜
        async function extractTextFromPDF(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        const typedArray = new Uint8Array(e.target.result);
                        const pdf = await pdfjsLib.getDocument(typedArray).promise;
                        let fullText = '';
                        
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            const pageText = textContent.items.map(item => item.str).join(' ');
                            fullText += pageText + '\n\n';
                        }
                        
                        resolve(fullText);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('íŒŒì¼ ì½ê¸° ì‹¤íŒ¨'));
                reader.readAsArrayBuffer(file);
            });
        }
        
        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        const uploadArea = document.querySelector('.upload-area');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('fileInput').files = files;
                handleFileUpload({ target: { files: files } });
            }
        });
        
        // AI ì§ˆë¬¸ ì²˜ë¦¬
        // async function askAI() {
        //     const question = document.getElementById('questionInput').value.trim();
        //     if (question) 
        // }
        //         showError('ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”')

async function askAI() {
    const question = document.getElementById('questionInput').value.trim();
    if (question) {
        // ì˜ˆì‹œ: ë¹„ë™ê¸° API í˜¸ì¶œ
        const response = await fetch('/api/ask', {
            method: 'POST',
            body: JSON.stringify({ question }),
            headers: { 'Content-Type': 'application/json' }
        });
        const data = await response.json();
        // ê²°ê³¼ ì²˜ë¦¬ ì½”ë“œ
        console.log(data);
    } else {
        alert('ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”.');
    }
}
